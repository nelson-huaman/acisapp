(()=>{var e={346:()=>{!function(){if(document.querySelector("#matricula")){let l=1,s=!1;const u=1,d=3,m={id:"",nombre:"",apellidoPaterno:"",apellidoMaterno:"",fechaNacimiento:"1991-01-01",tipoDocumento:"",numeroDocumento:"",email:"",telefono:"",idProfesion:1,idGrado:1,colegiatura:""};let p=[],v=[],f=[],_=[],h=[],y=[],L=[],E=[];document.querySelector(".dashboard");const S=document.querySelector("#cliente"),g=document.querySelector("#buscar-dni"),b=document.querySelector("#tipoDocumento"),q=document.querySelector("#numeroDocumento"),C=document.querySelector("#email"),w=document.querySelector("#nombre"),D=document.querySelector("#apellidoPaterno"),x=document.querySelector("#apellidoMaterno"),P=document.querySelector("#fechaNacimiento"),j=document.querySelector("#telefono"),k=document.querySelector("#profesion"),T=document.querySelector("#grado"),O=document.querySelector("#colegiatura"),A=document.querySelector("#resultado-busqueda"),N=document.querySelector("#lista-matriculas"),M=document.querySelector("#input-submit"),B=document.querySelector("#agregar-servicio");function e(e){return""===e.target.value.trim()&&"apellidoMaterno"!==e.target.id&&"fechaNacimiento"!==e.target.id&&"profesion"!==e.target.id&&"grado"!==e.target.id&&"colegiatura"!==e.target.id?(o(`El ${e.target.previousElementSibling.textContent} es obligatorio`,e.target.parentElement),e.target.classList.add("formulario__input--error"),m[e.target.name]="",void t()):"email"!==e.target.id||(a=e.target.value,/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/.test(a))?(function(e){const t=e.querySelector(".formulario__error");t&&(t.previousElementSibling.classList.remove("formulario__input--error"),t.remove())}(e.target.parentElement),m[e.target.name]=e.target.value.trim().toUpperCase(),void t()):(o(`El ${e.target.previousElementSibling.textContent} no es válido`,e.target.parentElement),e.target.classList.add("formulario__input--error"),m[e.target.name]="",void t());var a}function t(){if(e={nombre:w.value,apellidoPaterno:D.value,tipoDocumento:b.value,numeroDocumento:q.value,telefono:j.value},!Object.values(e).every(e=>""!==e))return M.classList.add("formulario__submit--disable"),void(M.disabled=!0);var e;M.classList.remove("formulario__submit--disable"),M.disabled=!1}function o(e,t){const o=document.createElement("SPAN");o.textContent=e,o.classList.add("formulario__error"),t.appendChild(o)}async function a(e){const t="/api/matricula?token="+e;try{const e=await fetch(t),o=await e.json();E=o.map(e=>e),n()}catch(e){console.log(e)}}function n(){i(N),E.forEach(e=>{const t=document.createElement("TR");t.classList.add("tabla__tr");const o=document.createElement("TD");var a;o.classList.add("tabla__td"),o.textContent=(a=e.idUsuario,p.filter(e=>e.id===a)[0].nombre);const n=document.createElement("TD");n.classList.add("tabla__td"),n.textContent=function(e){return _.filter(t=>t.id===e)[0].codigo}(e.idServicio);const r=document.createElement("TD");r.classList.add("tabla__td"),r.textContent=function(e){return h.filter(t=>t.id===e)[0].tipoBeneficio}(e.idBeneficio);const c=document.createElement("TD");c.classList.add("tabla__td"),c.textContent=e.fechaMatricula;const i=document.createElement("TD");i.classList.add("tabla__td"),i.textContent=e.condicion,t.appendChild(o),t.appendChild(n),t.appendChild(r),t.appendChild(c),t.appendChild(i),N.appendChild(t)})}function r(){const e=document.querySelector(".matricula__mostrar");e&&e.classList.remove("matricula__mostrar");const t="#paso-"+l;document.querySelector(t).classList.add("matricula__mostrar");const o=document.querySelector(".matricula__actual");o&&o.classList.remove("matricula__actual"),document.querySelector(`[data-paso="${l}"]`).classList.add("matricula__actual")}function c(){const e=document.querySelector("#anterior"),t=document.querySelector("#siguiente");1===l?(e.classList.add("matricula__ocultar"),t.classList.remove("matricula__ocultar")):3===l?(e.classList.remove("matricula__ocultar"),t.classList.add("matricula__ocultar")):(e.classList.remove("matricula__ocultar"),t.classList.remove("matricula__ocultar")),r()}function i(e){for(;e.firstChild;)e.removeChild(e.firstChild)}g.addEventListener("input",(function(e){const o=e.target.value;p.some(e=>e.numeroDocumento===o)?(y=p.filter(e=>e.numeroDocumento===o),s=!0):(y=[],s=!1),i(A),i(N),y.length?(y.forEach(e=>{const{id:o,nombre:n,apellidoPaterno:r,numeroDocumento:c}=e,i=document.createElement("LI");i.classList.add("matricula__li"),i.textContent=c+" - ",i.onclick=()=>{const e=document.querySelector(".matricula__selecionado");e&&e.classList.remove("matricula__selecionado"),i.classList.add("matricula__selecionado"),function(e){L=y.filter(t=>t.id===e),L.forEach(e=>{const{nombre:o,apellidoPaterno:a,apellidoMaterno:n,fechaNacimiento:r,tipoDocumento:c,numeroDocumento:i,email:l,telefono:s,idProfesion:u,idGrado:d,colegiatura:p}=e;w.value=o,D.value=a,x.value=n,P.value=r,b.value=c,q.value=i,C.value=l,j.value=s,k.value=u,T.value=d,O.value=p,M.value="Actualizar",Object.assign(m,e),t()})}(o),a(o)};const l=document.createElement("SPAN");l.textContent=`${n} ${r}`,i.appendChild(l),A.appendChild(i)}),n()):(E=[],function(){const e=document.createElement("P");e.classList.add("matricula__aviso"),e.textContent="Cliente no encontrado",A.appendChild(e)}(),w.value="",D.value="",x.value="",P.value="",b.value="",q.value="",C.value="",j.value="",k.value=1,T.value=1,O.value="",M.value="Guardar",function(){const e=document.createElement("TR");e.classList.add("tabla__tr");const t=document.createElement("TD");t.classList.add("tabla__td","tabla__td--noregistro"),t.colSpan="4",t.textContent="El Cliente no se a matrpiculado a ningun Servicio aún",e.appendChild(t),N.appendChild(e)}())})),b.addEventListener("change",e),q.addEventListener("input",e),C.addEventListener("change",e),w.addEventListener("input",e),D.addEventListener("input",e),x.addEventListener("input",e),P.addEventListener("input",e),j.addEventListener("input",e),k.addEventListener("input",e),T.addEventListener("input",e),O.addEventListener("input",e),S.addEventListener("submit",(function(e){e.preventDefault(),s?async function(){const e=new FormData;Object.entries(m).forEach(([t,o])=>{e.append(t,o)});try{const t=await fetch("/api/cliente",{method:"POST",body:e});"exito"===(await t.json()).tipo&&Swal.fire({icon:"success",title:"Cliente Actualizado",showConfirmButton:!1,timer:3e3})}catch(e){Swal.fire({icon:e,title:"Hubo un error al actualizar el cliente",showConfirmButton:!1,timer:3e3})}}():async function(){const e=new FormData;["nombre","apellidoPaterno","apellidoMaterno","fechaNacimiento","tipoDocumento","numeroDocumento","email","telefono","idProfesion","idGrado","colegiatura"].forEach(t=>{e.append(t,m[t])});try{const t=await fetch("/api/cliente",{method:"POST",body:e}),o=await t.json();"exito"===o.tipo&&(m.id=""+o.id,p=[...p,m],a(""+o.id),Swal.fire({icon:"success",title:"Cliente Creado",showConfirmButton:!1,timer:3e3}))}catch(e){Swal.fire({icon:e,title:"Hubo un error al crear el cliente",showConfirmButton:!1,timer:3e3})}}()})),B.addEventListener("click",(function(){const e=document.querySelector("#modal-servicio");e.classList.add("modal"),document.querySelector(".cerrar-modal").addEventListener("click",()=>{e.classList.remove("modal")})})),r(),document.querySelectorAll(".matricula__tabs button").forEach(e=>{e.addEventListener("click",e=>{l=parseInt(e.target.dataset.paso),r(),c()})}),c(),document.querySelector("#siguiente").addEventListener("click",()=>{l>=d||(l++,c())}),document.querySelector("#anterior").addEventListener("click",()=>{l<=u||(l--,c())}),async function(){try{const e=await fetch("/api/profesiones"),t=await e.json();v=t.map(e=>e),v.forEach(e=>{const{id:t,profesion:o}=e,a=document.createElement("OPTION");a.value=t,a.textContent=o,k.appendChild(a)})}catch(e){console.log(e)}}(),async function(){try{const e=await fetch("/api/grados"),t=await e.json();f=t.map(e=>e),f.forEach(e=>{const{id:t,gradoAcademico:o}=e,a=document.createElement("OPTION");a.value=t,a.textContent=o,T.appendChild(a)})}catch(e){console.log(e)}}(),async function(){try{const e=await fetch("/api/clientes"),t=await e.json();p=t.map(e=>e)}catch(e){console.log(e)}}(),async function(){try{const e=await fetch("/api/servicios"),t=await e.json();_=t.map(e=>e)}catch(e){console.log(e)}}(),async function(){try{const e=await fetch("/api/beneficios"),t=await e.json();h=t.map(e=>e)}catch(e){console.log(e)}}()}}()},398:()=>{!function(){const e=document.querySelector("#sidebar");if(e){const o=document.querySelector(".header__open-mobil"),a=document.querySelector(".header__open-pc"),n=document.querySelector(".sidebar__close"),r=document.querySelector(".sidebar__div"),c=document.querySelector(".expandir"),i="sidebar__show",l="sidebar__toogle",s="no-transition";let u;function t(){e.querySelectorAll("*").forEach(e=>e.classList.remove(s))}o.addEventListener("click",()=>e.classList.add(i)),a.addEventListener("click",()=>e.classList.toggle(l)),n.addEventListener("click",()=>e.classList.remove(i)),r.addEventListener("click",()=>e.classList.remove(i)),c.addEventListener("click",()=>document.documentElement.requestFullscreen()),window.addEventListener("resize",()=>{e.querySelectorAll("*").forEach(e=>e.classList.add(s)),clearInterval(u),u=setTimeout(t,500)});const d=document.querySelectorAll(".menu__item");d.forEach(e=>{e.addEventListener("click",()=>{d.forEach(e=>e.classList.remove("menu__activo")),e.querySelector(".menu__submenu")&&e.classList.add("menu__activo")})})}}()}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";o(398),o(346)})()})();
//# sourceMappingURL=app.js.map
